<!doctype html>
<html lang="">	
<head>
	<meta charset="utf-8"/>
	<title>Starbug</title>	
	<meta name="author" content="horlock">
	

	<link rel="top" href="#" /><link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic|Source+Code+Pro' rel='stylesheet' type='text/css'></link>
	<link rel="stylesheet" href="https://holrock.github.io/theme/css/main.css" type="text/css" />
		

    <link href="https://holrock.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Starbug Atom Feed" />
</head>
	
<body>

    <div class="container">
	  
	  <header role="banner">
	    <div class="feeds">
	        <a href="https://holrock.github.io/feeds/all.atom.xml" rel="alternate"><img src="https://holrock.github.io/theme/images/icons/feed-32px.png" alt="atom feed"/></a>
	    </div>
		<a href="https://holrock.github.io" class="title">Starbug</a>
      </header>
	
	  <div class="wrapper">

		  <div role="main" class="content">



      <article>
        <h1><a href="https://holrock.github.io/allegrograph-sono2.html">AllegroGraph その2</a></h1>
        <p>AllegroGraphが動くようになったので、データ作って投入します。</p>
<p>データは<a href="https://www.cattoy.info">cattoy</a>から作ります。</p>
<p><a href="https://github.com/holrock/cattoy/commit/202415749077a2820bff11d3544af3fc03453b65">こんなかんじ</a>
にRDF出力コードを仕込んだので、</p>
<div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="no">RDF</span><span class="o">::</span><span class="no">Graph</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">tap</span> <span class="p">{</span><span class="o">|</span><span class="n">g</span><span class="o">|</span> <span class="no">Cat</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">c</span><span class="o">|</span> <span class="n">g</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">to_rdf</span> <span class="p">}}</span>
<span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/tmp/cat.ttl&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="n">g</span><span class="o">.</span><span class="n">to_ttl</span> <span class="p">}</span>
</pre></div>


<p>でファイルに吐き出します。
なかみはこんなかんじです。</p>
<div class="highlight"><pre><span></span><span class="k">@prefix</span> <span class="nt">schema</span><span class="o">:</span> <span class="o">&lt;</span><span class="nt">http</span><span class="o">://</span><span class="nt">schema</span><span class="nc">.org</span><span class="o">/&gt;</span> <span class="o">.</span>
<span class="k">@prefix</span> <span class="nt">xsd</span><span class="o">:</span> <span class="o">&lt;</span><span class="nt">http</span><span class="o">://</span><span class="nt">www</span><span class="nc">.w3.org</span><span class="o">/</span><span class="nt">2001</span><span class="o">/</span><span class="nt">XMLSchema</span><span class="err">#</span><span class="o">&gt;</span> <span class="o">.</span>

<span class="o">&lt;</span><span class="nt">http</span><span class="o">://</span><span class="nt">www</span><span class="nc">.cattoy.info</span><span class="o">/</span><span class="nt">histories</span><span class="o">/</span><span class="nt">1</span><span class="o">&gt;</span> <span class="nt">schema</span><span class="nd">:creator</span> <span class="o">&lt;</span><span class="nt">http</span><span class="o">://</span><span class="nt">www</span><span class="nc">.cattoy.info</span><span class="o">/</span><span class="nt">cats</span><span class="o">/</span><span class="nt">1</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="nt">schema</span><span class="nd">:itemReviewed</span> <span class="o">&lt;</span><span class="nt">http</span><span class="o">://</span><span class="nt">www</span><span class="nc">.cattoy.info</span><span class="o">/</span><span class="nt">toys</span><span class="o">/</span><span class="nt">1</span><span class="o">&gt;</span><span class="p">;</span>
   <span class="nt">schema</span><span class="nd">:ratingValue</span> <span class="nt">1</span><span class="o">;</span>
   <span class="nt">schema</span><span class="nd">:reviewBody</span> <span class="s2">&quot;羽よりネズミが好き。音がして嚙めるものが好きっぽい&quot;</span> <span class="o">.</span>

<span class="o">&lt;</span><span class="nt">http</span><span class="o">://</span><span class="nt">www</span><span class="nc">.cattoy.info</span><span class="o">/</span><span class="nt">histories</span><span class="o">/</span><span class="nt">10</span><span class="o">&gt;</span> <span class="nt">schema</span><span class="nd">:creator</span> <span class="o">&lt;</span><span class="nt">http</span><span class="o">://</span><span class="nt">www</span><span class="nc">.cattoy.info</span><span class="o">/</span><span class="nt">cats</span><span class="o">/</span><span class="nt">1</span><span class="o">&gt;;</span>
   <span class="nt">schema</span><span class="nd">:itemReviewed</span> <span class="o">&lt;</span><span class="nt">http</span><span class="o">://</span><span class="nt">www</span><span class="nc">.cattoy.info</span><span class="o">/</span><span class="nt">toys</span><span class="o">/</span><span class="nt">10</span><span class="o">&gt;;</span>
   <span class="nt">schema</span><span class="nd">:ratingValue</span> <span class="nt">1</span><span class="o">;</span>
   <span class="nt">schema</span><span class="nd">:reviewBody</span> <span class="s2">&quot;たまに猫キックしてた&quot;</span> <span class="o">.</span>

<span class="o">&lt;</span><span class="nt">http</span><span class="o">://</span><span class="nt">www</span><span class="nc">.cattoy.info</span><span class="o">/</span><span class="nt">cats</span><span class="o">/</span><span class="nt">1</span><span class="o">&gt;</span> <span class="nt">schema</span><span class="nd">:name</span> <span class="s2">&quot;みけ&quot;</span> <span class="o">.</span>
</pre></div>


<p>これをWebViewに取り込んで、クエリを投げます</p>
<div class="highlight"><pre><span></span><span class="nt">prefix</span> <span class="nt">sc</span><span class="o">:</span> <span class="o">&lt;</span><span class="nt">http</span><span class="o">://</span><span class="nt">schema</span><span class="nc">.org</span><span class="o">/&gt;</span>

<span class="nt">select</span> <span class="o">?</span><span class="nt">cat</span> <span class="o">?</span><span class="nt">history</span> <span class="o">?</span><span class="nt">body</span> <span class="p">{</span>
  <span class="o">?</span><span class="n">cat</span> <span class="n">sc</span><span class="o">:</span><span class="n">name</span> <span class="s2">&quot;みけ&quot;</span><span class="o">.</span>
  <span class="o">?</span><span class="n">history</span> <span class="n">sc</span><span class="o">:</span><span class="n">creator</span> <span class="o">?</span><span class="n">cat</span><span class="p">;</span>
  <span class="n">sc</span><span class="o">:</span><span class="n">reviewBody</span> <span class="o">?</span><span class="n">body</span><span class="p">;</span>
  <span class="n">sc</span><span class="o">:</span><span class="n">ratingValue</span> <span class="s2">&quot;-1&quot;</span><span class="o">^^&lt;</span><span class="n">http</span><span class="o">://</span><span class="n">www</span><span class="o">.</span><span class="n">w3</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="m">2001</span><span class="o">/</span><span class="n">XMLSchema</span><span class="m">#intege</span><span class="n">r</span><span class="o">&gt;.</span>
<span class="p">}</span>
</pre></div>


<p>結果は</p>
<div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;head&quot;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;vars&quot;</span> <span class="o">:</span> <span class="p">[</span>
         <span class="s2">&quot;cat&quot;</span><span class="p">,</span>
         <span class="s2">&quot;history&quot;</span><span class="p">,</span>
         <span class="s2">&quot;body&quot;</span>
      <span class="p">]</span>
   <span class="p">},</span>
   <span class="s2">&quot;results&quot;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;bindings&quot;</span> <span class="o">:</span> <span class="p">[</span>
         <span class="p">{</span>
            <span class="s2">&quot;history&quot;</span> <span class="o">:</span> <span class="p">{</span>
               <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="s2">&quot;http://www.cattoy.info/histories/107&quot;</span><span class="p">,</span>
               <span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;uri&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;body&quot;</span> <span class="o">:</span> <span class="p">{</span>
               <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="s2">&quot;これのピンク色のやつ\r\n音に期待したけど全然だめ。だめ&quot;</span><span class="p">,</span>
               <span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;literal&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;cat&quot;</span> <span class="o">:</span> <span class="p">{</span>
               <span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;uri&quot;</span><span class="p">,</span>
               <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="s2">&quot;http://www.cattoy.info/cats/1&quot;</span>
            <span class="p">}</span>
         <span class="p">},</span>
         <span class="p">{</span>
            <span class="s2">&quot;cat&quot;</span> <span class="o">:</span> <span class="p">{</span>
               <span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;uri&quot;</span><span class="p">,</span>
               <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="s2">&quot;http://www.cattoy.info/cats/1&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;history&quot;</span> <span class="o">:</span> <span class="p">{</span>
               <span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;uri&quot;</span><span class="p">,</span>
               <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="s2">&quot;http://www.cattoy.info/histories/2&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;body&quot;</span> <span class="o">:</span> <span class="p">{</span>
               <span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;literal&quot;</span><span class="p">,</span>
               <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="s2">&quot;鉄のストラップの方に興味が行くほど、光線に興味なし。&quot;</span>
            <span class="p">}</span>
         <span class="p">},</span>
         <span class="c1">// snip</span>
</pre></div>


<p>無事取れてますが、これがないとダメでした。</p>
<div class="highlight"><pre><span></span>  sc:ratingValue &quot;-1&quot;^^&lt;http://www.w3.org/2001/XMLSchema#integer&gt;.
</pre></div>


<p>しかし、述語選ぶのが大変ですね。</p>
      </article>

      <hr />

        <div>
          <h3>Last posts</h3>
          <ol class="archive">
    


      <li>
<a href="https://holrock.github.io/allegrograph-sono1.html" rel="bookmark" title="Permalink to AllegroGraph その1">AllegroGraph その1</a>
  <time datetime="2016-11-03T00:00:00+09:00" pubdate>木 03 11月 2016</time>
<p class="tags">tags: <a href="https://holrock.github.io/tag/lisp.html">lisp</a><a href="https://holrock.github.io/tag/allegrograph.html">allegrograph</a></p></a>      </li>


      <li>
<a href="https://holrock.github.io/macos-10121niagetaralibcryptogajian-tsukaranai.html" rel="bookmark" title="Permalink to macOS 10.12.1にあげたらlibcryptoが見つからない">macOS 10.12.1にあげたらlibcryptoが見つからない</a>
  <time datetime="2016-11-02T00:00:00+09:00" pubdate>水 02 11月 2016</time>
<p class="tags">tags: <a href="https://holrock.github.io/tag/ocaml.html">ocaml</a></p></a>      </li>


      <li>
<a href="https://holrock.github.io/cattoynihua-xiang-proxyworu-remashita.html" rel="bookmark" title="Permalink to cattoyに画像proxyを入れました">cattoyに画像proxyを入れました</a>
  <time datetime="2016-10-31T00:00:00+09:00" pubdate>月 31 10月 2016</time>
<p class="tags">tags: <a href="https://holrock.github.io/tag/omac.html">omac</a><a href="https://holrock.github.io/tag/ocaml.html">ocaml</a><a href="https://holrock.github.io/tag/cattoy.html">cattoy</a></p></a>      </li>


      <li>
<a href="https://holrock.github.io/conduit-with-homebrew-openssl.html" rel="bookmark" title="Permalink to conduit with homebrew openssl">conduit with homebrew openssl</a>
  <time datetime="2016-10-28T00:00:00+09:00" pubdate>金 28 10月 2016</time>
<p class="tags">tags: <a href="https://holrock.github.io/tag/ocaml.html">ocaml</a></p></a>      </li>


      <li>
<a href="https://holrock.github.io/chainerdefen-lei-dekitenai.html" rel="bookmark" title="Permalink to chainerで分類(できてない)">chainerで分類(できてない)</a>
  <time datetime="2016-10-25T00:00:00+09:00" pubdate>火 25 10月 2016</time>
<p class="tags">tags: <a href="https://holrock.github.io/tag/chainer.html">chainer</a><a href="https://holrock.github.io/tag/python.html">python</a></p></a>      </li>






          </ol>
        </div>

		  </div>	
		  
		  <div class="sidebar">

	        <nav>
	          <h2>Categories</h2>
	          <ul>
	              <li ><a href="https://holrock.github.io/category/cattoy.html">cattoy</a></li>
	              <li ><a href="https://holrock.github.io/category/lisp.html">lisp</a></li>
	              <li ><a href="https://holrock.github.io/category/ocaml.html">ocaml</a></li>
	              <li ><a href="https://holrock.github.io/category/python.html">python</a></li>
	          </ul>
	        </nav>

	          <aside>
	          <h2>Social</h2>
			    <ul class="social">
				  <li><a href="https://github.com/holrock/">github</a><i></i></li>
			    </ul>
			  </aside>


		  </div>

	  </div>

      <footer>
		<p role="contentinfo">
		  © 2016 horlock - Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Theme <a href="https://github.com/fle/pelican-simplegrey">pelican-simplegrey</a>.
    	</p>

	  </footer>	

	</div>
	

</body>
</html>